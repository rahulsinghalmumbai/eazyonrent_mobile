<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="eazyonrent.Pages.ItemDetails"
             Title="Item Details"
             BackgroundColor="#F8F9FA">
    <Grid RowDefinitions="*,Auto">

        <ScrollView>
            <VerticalStackLayout Spacing="20" Padding="16">

                <!-- Image Gallery Section -->
                <Frame BackgroundColor="White" CornerRadius="15" HasShadow="True" Padding="16">
                    <VerticalStackLayout Spacing="15">
                        <!-- Main Image Display -->
                        <Frame CornerRadius="10" HasShadow="False" Padding="0" HeightRequest="300">
                            <Grid>
                                <Image x:Name="MainImage" 
                                   Source="{Binding CurrentImage}"
                                   Aspect="AspectFill"
                                   BackgroundColor="#F0F0F0"/>

                                <!-- Navigation Buttons -->
                                <Button x:Name="PrevButton" 
                                    Text="â®" 
                                    BackgroundColor="White" 
                                    TextColor="Black"
                                    WidthRequest="40" 
                                    HeightRequest="40"
                                    CornerRadius="20"
                                    HorizontalOptions="Start" 
                                    VerticalOptions="Center"
                                    Margin="10,0,0,0"
                                    Clicked="OnPrevImageClicked"/>

                                <Button x:Name="NextButton" 
                                    Text="â¯" 
                                    BackgroundColor="White" 
                                    TextColor="Black"
                                    WidthRequest="40" 
                                    HeightRequest="40"
                                    CornerRadius="20"
                                    HorizontalOptions="End" 
                                    VerticalOptions="Center"
                                    Margin="0,0,10,0"
                                    Clicked="OnNextImageClicked"/>

                                <!-- Zoom Controls -->
                                <VerticalStackLayout HorizontalOptions="End" 
                                               VerticalOptions="End" 
                                               Spacing="5" 
                                               Margin="10">
                                    <Button Text="ðŸ”+" 
                                        BackgroundColor="White" 
                                        TextColor="Black"
                                        WidthRequest="40" 
                                        HeightRequest="40"
                                        CornerRadius="20"
                                        Clicked="OnZoomInClicked"/>
                                    <Button Text="ðŸ”-" 
                                        BackgroundColor="White" 
                                        TextColor="Black"
                                        WidthRequest="40" 
                                        HeightRequest="40"
                                        CornerRadius="20"
                                        Clicked="OnZoomOutClicked"/>
                                </VerticalStackLayout>

                                <!-- Image Counter -->
                                <Label x:Name="ImageCounter"
                                   Text="{Binding ImageCounterText}"
                                   BackgroundColor="Black" 
                                   TextColor="White"
                                   Padding="8,4"
                                   HorizontalOptions="Start" 
                                   VerticalOptions="End"
                                   Margin="10"
                                   FontSize="12"/>
                            </Grid>
                        </Frame>

                        <!-- Thumbnail Strip -->
                        <CollectionView x:Name="ThumbnailCollection" 
                                    ItemsSource="{Binding ItemImages}"
                                    ItemsLayout="HorizontalList"
                                    HeightRequest="80"
                                    SelectionMode="Single"
                                    SelectionChanged="OnThumbnailSelectionChanged">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="5">
                                        <Frame CornerRadius="8" HasShadow="False" Padding="0">
                                            <Image Source="{Binding .}" 
                                               WidthRequest="70" 
                                               HeightRequest="70"
                                               Aspect="AspectFill"/>
                                        </Frame>
                                    </Grid>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                </Frame>

                <!-- Category Selection --><!--
                <Frame BackgroundColor="White" CornerRadius="15" HasShadow="True" Padding="16">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Category" FontSize="16" FontAttributes="Bold" TextColor="#333"/>
                        <Picker x:Name="CategoryPicker" 
                            ItemsSource="{Binding Categories}"
                            ItemDisplayBinding="{Binding CategoriesName}"
                            SelectedItem="{Binding SelectedCategory}"
                            BackgroundColor="#F8F9FA"
                            TextColor="#333"/>
                    </VerticalStackLayout>
                </Frame>-->

                <!-- Item Information -->
                <Frame BackgroundColor="White" CornerRadius="15" HasShadow="True" Padding="16">
                    <VerticalStackLayout Spacing="15">
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Category Name:" FontSize="14" TextColor="#666"/>
                            <Label Text="{Binding ItemData.CategoryId}" FontSize="18" FontAttributes="Bold" TextColor="#333"/>
                        </VerticalStackLayout>

                        <!-- Company Name -->
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Company Name:" FontSize="14" TextColor="#666"/>
                            <Label Text="{Binding ItemData.CompanyName}" FontSize="18" FontAttributes="Bold" TextColor="#333"/>
                        </VerticalStackLayout>

                        <!-- Item Name -->
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Item Name:" FontSize="14" TextColor="#666"/>
                            <Label Text="{Binding ItemData.ItemName}" FontSize="22" FontAttributes="Bold" TextColor="#1E40AF"/>
                        </VerticalStackLayout>

                        <!-- Description -->
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Description:" FontSize="14" TextColor="#666"/>
                            <Label Text="{Binding ItemData.ItemDescriptions}" FontSize="16" TextColor="#333" LineBreakMode="WordWrap"/>
                        </VerticalStackLayout>

                        <!-- Cost -->
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Cost:" FontSize="14" TextColor="#666"/>
                            <Label Text="{Binding FormattedCost}" FontSize="28" FontAttributes="Bold" TextColor="#059669"/>
                        </VerticalStackLayout>

                        <!-- Available From -->
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Available From:" FontSize="14" TextColor="#666"/>
                            <Label Text="{Binding FormattedAvailableDate}" FontSize="16" TextColor="#333"/>
                        </VerticalStackLayout>

                        <!-- Location -->
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Location:" FontSize="14" TextColor="#666"/>
                            <Label Text="{Binding ItemData.Location}" FontSize="16" TextColor="#333"/>
                        </VerticalStackLayout>

                        <!-- Booking Status -->
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Status:" FontSize="14" TextColor="#666"/>
                            <Frame BackgroundColor="#DCFCE7" CornerRadius="20" HasShadow="False" Padding="12,6">
                                <Label Text="Available" TextColor="#166534" FontAttributes="Bold" HorizontalOptions="Center"/>
                            </Frame>
                        </VerticalStackLayout>

                        <!-- Rating and Views -->
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="20">
                            <VerticalStackLayout Grid.Column="0" Spacing="5">
                                <Label Text="Rating:" FontSize="14" TextColor="#666"/>
                                <HorizontalStackLayout Spacing="5">
                                    <Label Text="â­â­â­â­â­" FontSize="18"/>
                                    <Label Text="Very Good" FontSize="14" TextColor="#666" VerticalOptions="Center"/>
                                </HorizontalStackLayout>
                            </VerticalStackLayout>

                            <VerticalStackLayout Grid.Column="1" Spacing="5">
                                <Label Text="Views:" FontSize="14" TextColor="#666"/>
                                <Label Text="{Binding ViewCount}" FontSize="16" TextColor="#333"/>
                            </VerticalStackLayout>
                        </Grid>

                    </VerticalStackLayout>
                </Frame>

                <!-- Similar Items Section -->
                <Frame BackgroundColor="White" CornerRadius="15" HasShadow="True" Padding="16">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="Similar Items" FontSize="20" FontAttributes="Bold" TextColor="#333"/>

                        <CollectionView x:Name="SimilarItemsCollection" 
                                    ItemsSource="{Binding SimilarItems}"
                                    ItemsLayout="HorizontalList"
                                    HeightRequest="220">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="10" WidthRequest="180">
                                        <Frame BackgroundColor="#F8F9FA" CornerRadius="10" HasShadow="True" Padding="12">
                                            <VerticalStackLayout Spacing="10">
                                                <Image Source="{Binding Images[0]}" 
                                                   WidthRequest="140" 
                                                   HeightRequest="100"
                                                   Aspect="AspectFill"/>
                                                <Label Text="{Binding ItemName}" 
                                                   FontSize="14" 
                                                   FontAttributes="Bold" 
                                                   TextColor="#333"
                                                   LineBreakMode="TailTruncation"/>
                                                <Label Text="{Binding ItemCost, StringFormat='â‚¹{0}'}" 
                                                   FontSize="16" 
                                                   FontAttributes="Bold" 
                                                   HorizontalTextAlignment="End"
                                                   TextColor="#059669"/>
                                            </VerticalStackLayout>
                                            <!-- Tap Gesture for Similar Items -->
                                            <Frame.GestureRecognizers>
                                                <TapGestureRecognizer Tapped="OnSimilarItemTapped" 
                      CommandParameter="{Binding .}"/>
                                            </Frame.GestureRecognizers>
                                        </Frame>

                                        
                                    </Grid>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                </Frame>

                <!-- Action Buttons -->


            </VerticalStackLayout>
        </ScrollView>
        <Frame BackgroundColor="White" HasShadow="True" Padding="16" Grid.Row="1">
            <Grid ColumnDefinitions="*,*" ColumnSpacing="15">
                <Button Grid.Column="0"
                  Text="ðŸ’¬ Chat"
                  BackgroundColor="#3B82F6"
                  TextColor="White"
                  FontSize="18"
                  FontAttributes="Bold"
                  HeightRequest="50"
                  CornerRadius="25"
                  Clicked="OnChatClicked"/>

                <Button Grid.Column="1"
                  Text="ðŸ“… Book Now"
                  BackgroundColor="#059669"
                  TextColor="White"
                  FontSize="18"
                  FontAttributes="Bold"
                  HeightRequest="50"
                  CornerRadius="25"
                  Clicked="OnBookNowClicked"/>
            </Grid>
        </Frame>
    </Grid>
</ContentPage>